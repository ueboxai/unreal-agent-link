# 编辑器工具接口

## 抓取当前视口截图 `editor.screenshot`
从当前 Editor 视口（优先使用 GEditor 活跃视口，否则 GameViewport）抓屏，编码为 PNG，并返回 Base64 与本地保存路径。已通过 `UAL_VersionCompat` 适配 UE5.0–5.7（内部封装了 `IImageWrapper::GetCompressed` 的 5.0/5.1+ 差异）。  
兼容旧名 `take_screenshot`（未来可逐步下线）。

### 请求（JSON-RPC）
```json
{"ver":"1.0","type":"req","id":"cap1","method":"editor.screenshot","params":{
  "filepath":"UAL_shot.png",      // 可选，文件名或路径，默认 Saved/Screenshots/UAL/ 下按时间戳命名
  "resolution":[1280,720],        // 可选，[width,height]，不填则按视口原分辨率；内部使用最近邻缩放
  "show_ui":false                 // 可选，是否包含 UI（当前逻辑不剔除 UI，预留字段）
}}
```

### 响应
```json
{"ver":"1.0","type":"res","id":"cap1","code":200,"result":{
  "path":"I:/UnrealAgent/UALinkDev/Saved/Screenshots/UAL/UAL_shot.png",
  "filename":"UAL_shot.png",
  "width":1280,
  "height":720,
  "saved":true,
  "show_ui":false,
  "base64":"iVBORw0KGgoAAA...",      // PNG 数据的 base64
  "save_error":"Failed to write screenshot to disk" // 仅在写盘失败时出现
}}
```

### 说明
- 默认保存目录：`Saved/Screenshots/UAL/`，会自动创建。
- `resolution` 不填则按视口当前分辨率；如填写，使用最近邻缩放。
- 失败时返回 `code` 500，`error.message` 描述原因（如无可用视口、像素读取/编码失败、写盘失败）。带 base64 即可直接传输给服务端。
- 版本兼容：后续若有新增 API 差异，请统一追加到 `UAL_VersionCompat`，业务层无需再写版本宏。 

